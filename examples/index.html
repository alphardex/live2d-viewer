<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Live2D Viewer Demo</title>
  <!-- Live2D Cubism Core -->
  <script src="https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js"></script>
  <script src="/live2dcubismcore.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .demo-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .demo-card h3 {
      margin-top: 0;
      color: #333;
    }

    live2d-viewer {
      width: 100%;
      height: 300px;
      border: 2px solid #eee;
      border-radius: 8px;
      display: block;
      margin: 10px 0;
    }

    .controls {
      margin-top: 10px;
    }

    .controls button {
      background: #667eea;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      margin-right: 10px;
      margin-bottom: 5px;
      cursor: pointer;
    }

    .controls button:hover {
      background: #5a6fd8;
    }

    .controls input {
      padding: 6px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-right: 10px;
      margin-bottom: 5px;
    }

    .controls input[type="url"] {
      box-sizing: border-box;
      background: white;
      padding: 8px;
      border: 2px solid #667eea;
      border-radius: 6px;
      width: 100%;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .controls input[type="url"]:focus {
      border-color: #5a6fd8;
      outline: none;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
    }

    .controls select {
      background: white;
      padding: 8px;
      border: 2px solid #667eea;
      border-radius: 6px;
      margin-right: 10px;
      margin-bottom: 5px;
    }

    .status-info {
      color: #2196f3;
      font-weight: bold;
    }

    .status-success {
      color: #4caf50;
      font-weight: bold;
    }

    .status-error {
      color: #f44336;
      font-weight: bold;
    }

    #motion-list,
    #expression-list {
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      margin-top: 10px;
      background: #f9f9f9;
    }

    #motion-list ul,
    #expression-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #motion-list li,
    #expression-list li {
      margin-bottom: 5px;
    }

    #motion-list button,
    #expression-list button {
      background: #4caf50;
      font-size: 12px;
      padding: 4px 8px;
    }

    #motion-list button:hover,
    #expression-list button:hover {
      background: #45a049;
    }

    .disclaimer {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
      color: #856404;
    }

    .disclaimer p {
      margin: 0;
      line-height: 1.6;
    }
  </style>
</head>

<body>
  <a href="https://github.com/alphardex/live2d-viewer" target="_blank" class="github-corner"
    aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250"
      style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" />
      <path
        d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
        fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm" />
      <path
        d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
        fill="currentColor" class="octo-body" />
    </svg></a>
  <style>
    .github-corner:hover .octo-arm {
      animation: octocat-wave 560ms ease-in-out
    }

    @keyframes octocat-wave {

      0%,
      100% {
        transform: rotate(0)
      }

      20%,
      60% {
        transform: rotate(-25deg)
      }

      40%,
      80% {
        transform: rotate(10deg)
      }
    }

    @media (max-width:500px) {
      .github-corner:hover .octo-arm {
        animation: none
      }

      .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
      }
    }
  </style>
  <div class="container">
    <h1>ğŸ­ Live2D Viewer Demo</h1>

    <div class="demo-grid">
      <!-- åŸºç¡€æ¼”ç¤º -->
      <div class="demo-card">
        <h3>ğŸ“± åŸºç¡€æ¼”ç¤º</h3>
        <live2d-viewer id="viewer1" src="/kanade-live2d/17kanade_cloth001_3.0_f_t02.model3.json"
          motion="w-kanade-glad01" auto-interact="false" y="2.5"></live2d-viewer>
        <div class="controls">
          <button onclick="changeScale('viewer1', 0.1)">ç¼©å°</button>
          <button onclick="changeScale('viewer1', 0.15)">æ­£å¸¸</button>
          <button onclick="changeScale('viewer1', 0.2)">æ”¾å¤§</button>
        </div>
      </div>

      <!-- åŠ¨ä½œæ§åˆ¶ -->
      <div class="demo-card">
        <h3>ğŸ¬ åŠ¨ä½œæ§åˆ¶</h3>
        <live2d-viewer id="viewer2"
          src="https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/shizuku/shizuku.model.json"></live2d-viewer>
        <div class="controls">
          <button onclick="listMotions('viewer2')">è·å–åŠ¨ä½œåˆ—è¡¨</button>
          <button onclick="randomMotion('viewer2')">éšæœºåŠ¨ä½œ</button>
          <div id="motion-list"></div>
        </div>
      </div>

      <!-- è¡¨æƒ…æ§åˆ¶ -->
      <div class="demo-card">
        <h3>ğŸ˜Š è¡¨æƒ…æ§åˆ¶</h3>
        <live2d-viewer id="viewer3"
          src="https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/shizuku/shizuku.model.json"></live2d-viewer>
        <div class="controls">
          <button onclick="listExpressions('viewer3')">è·å–è¡¨æƒ…åˆ—è¡¨</button>
          <button onclick="randomExpression('viewer3')">éšæœºè¡¨æƒ…</button>
          <div id="expression-list"></div>
        </div>
      </div>

      <!-- åŠ¨æ€åŠ è½½ -->
      <!-- <div class="demo-card">
          <h3>ğŸ”„ åŠ¨æ€åŠ è½½</h3>
          <live2d-viewer
            id="viewer4"
            src="https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/shizuku/shizuku.model.json"
          ></live2d-viewer>
          <div class="controls">
            <input
              type="url"
              id="model-url"
              placeholder="è¾“å…¥Live2Dæ¨¡å‹URL (model.jsonæˆ–model3.json)"
              value="https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/haru/haru_greeter_t03.model3.json"
            />
            <button onclick="loadModelFromUrl()">åŠ è½½æ¨¡å‹</button>
            <button onclick="resetToDefault()">é‡ç½®é»˜è®¤</button>
            <div id="upload-status"></div>
          </div>
        </div> -->
    </div>

    <div class="disclaimer">
      <p>æœ¬ç½‘ç«™ç”¨åˆ°çš„live2DåŠ¨ç”»éƒ¨åˆ†æ¥æºäºsekai.bestï¼Œæ‰€æœ‰ç‰ˆæƒå½’å…¶åˆæ³•æ‰€æœ‰è€…æ‰€æœ‰ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº Segaã€Colorful Palette å’Œ
        Cryptonã€‚æœ¬ç½‘ç«™æ‰€æœ‰å†…å®¹ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç›®çš„ï¼Œä»¥ä¾¿è®©æ›´å¤šçš„äººäº†è§£å’Œç†Ÿæ‚‰live2DåŠ¨ç”»æŠ€æœ¯ã€‚</p>
    </div>

    <!-- <live2d-viewer-multi id="viewer1" src="/kanade-live2d/17kanade_cloth001_3.0_f_t02.model3.json"
      motion="w-kanade-glad01" auto-interact="false" x="0.25" y="0.75" scale="0.24"></live2d-viewer-multi>
    <live2d-viewer-multi id="viewer2" src="/kanade-live2d/17kanade_cloth001_3.0_f_t02.model3.json"
      motion="w-kanade-glad01" auto-interact="false" x="0.75" y="0.75" scale="0.24"></live2d-viewer-multi> -->
  </div>

  <script type="module">
    // å¯¼å…¥live2d-viewerç»„ä»¶
    // import "../dist/live2d-viewer-multi.js";
    import "../dist/index.esm.js";
    // import "@alphardex/live2d-viewer";
  </script>
  <script>
    function changeScale(viewerId, scale) {
      const viewer = document.getElementById(viewerId);
      viewer.setScale(scale);
    }

    function listMotions(viewerId) {
      const viewer = document.getElementById(viewerId);
      const motions = viewer.getMotions();
      const listElement = document.getElementById("motion-list");

      if (motions.length > 0) {
        listElement.innerHTML =
          "<h4>å¯ç”¨åŠ¨ä½œ:</h4><ul>" +
          motions
            .map(
              (motion) =>
                `<li><button onclick="setMotion('${viewerId}', '${motion}')">${motion}</button></li>`
            )
            .join("") +
          "</ul>";
      } else {
        listElement.innerHTML = "<p>æš‚æ— åŠ¨ä½œæ•°æ®</p>";
      }
    }

    function setMotion(viewerId, motionName) {
      const viewer = document.getElementById(viewerId);
      viewer.setMotion(motionName);
    }

    function randomMotion(viewerId) {
      const viewer = document.getElementById(viewerId);
      const motions = viewer.getMotions();

      if (motions.length > 0) {
        const randomMotion = motions[Math.floor(Math.random() * motions.length)];
        viewer.setMotion(randomMotion);
      }
    }

    function listExpressions(viewerId) {
      const viewer = document.getElementById(viewerId);
      const expressions = viewer.getExpressions();
      const listElement = document.getElementById("expression-list");

      if (expressions.length > 0) {
        listElement.innerHTML =
          "<h4>å¯ç”¨è¡¨æƒ…:</h4><ul>" +
          expressions
            .map(
              (expression) =>
                `<li><button onclick="setExpression('${viewerId}', '${expression}')">${expression}</button></li>`
            )
            .join("") +
          "</ul>";
      } else {
        listElement.innerHTML = "<p>æš‚æ— è¡¨æƒ…æ•°æ®</p>";
      }
    }

    function setExpression(viewerId, expressionName) {
      const viewer = document.getElementById(viewerId);
      viewer.setExpression(expressionName);
    }

    function randomExpression(viewerId) {
      const viewer = document.getElementById(viewerId);
      const expressions = viewer.getExpressions();

      if (expressions.length > 0) {
        const randomExpression = expressions[Math.floor(Math.random() * expressions.length)];
        viewer.setExpression(randomExpression);
      }
    }

    function loadModelFromUrl() {
      const urlInput = document.getElementById('model-url');
      const statusElement = document.getElementById('upload-status');
      const modelUrl = urlInput.value.trim();

      if (!modelUrl) {
        statusElement.className = 'status-error';
        statusElement.textContent = 'è¯·è¾“å…¥æ¨¡å‹æ–‡ä»¶è·¯å¾„';
        return;
      }

      // æ£€æŸ¥æ–‡ä»¶æ‰©å±•å
      const validExtensions = ['.model.json', '.model3.json'];
      const hasValidExtension = validExtensions.some(ext => modelUrl.toLowerCase().includes(ext));

      if (!hasValidExtension) {
        statusElement.className = 'status-error';
        statusElement.textContent = 'è·¯å¾„åº”è¯¥æŒ‡å‘ .model.json æˆ– .model3.json æ ¼å¼çš„Live2Dæ¨¡å‹æ–‡ä»¶';
        return;
      }

      statusElement.className = 'status-info';
      statusElement.textContent = 'æ­£åœ¨åŠ è½½Live2Dæ¨¡å‹...';

      const viewer = document.getElementById('viewer4');

      try {
        // å°è¯•åŠ è½½æ–°çš„Live2Dæ¨¡å‹
        viewer.renderLive2D({
          src: modelUrl,
        });

        statusElement.className = 'status-success';
        statusElement.textContent = `Live2Dæ¨¡å‹åŠ è½½æˆåŠŸï¼`;
      } catch (error) {
        statusElement.className = 'status-error';
        statusElement.textContent = `åŠ è½½å¤±è´¥: ${error.message}`;
        console.error('Live2DåŠ è½½é”™è¯¯:', error);
      }
    }

    function resetToDefault() {
      const viewer = document.getElementById('viewer4');
      const statusElement = document.getElementById('upload-status');
      const urlInput = document.getElementById('model-url');

      // é‡ç½®ä¸ºé»˜è®¤Live2Dæ¨¡å‹
      viewer.setAttribute('src', 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/shizuku/shizuku.model.json');

      // æ¸…ç©ºURLè¾“å…¥å’ŒçŠ¶æ€
      urlInput.value = 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/haru/haru_greeter_t03.model3.json';
      statusElement.className = 'status-info';
      statusElement.textContent = 'å·²é‡ç½®ä¸ºé»˜è®¤Live2Dæ¨¡å‹';

      // 3ç§’åæ¸…é™¤çŠ¶æ€ä¿¡æ¯
      setTimeout(() => {
        statusElement.textContent = '';
        statusElement.className = '';
      }, 3000);
    }
  </script>
</body>

</html>